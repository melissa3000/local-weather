<!DOCTYPE html>
<html lang="en">


<head>
  <meta charset="utf-8">
  <title>Your Local Weather</title>

   <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- FONT - font awesome
    –––––––––––––––––––––––––––––––––––––––––––––––––– -->
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- CSS - bootstrap
    –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">


    <!-- Favicon (UPDATE needed)
    –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <!-- <link rel="icon" type="image/png" href="/static/umbrella.png"> -->

    <!-- Links to jQuery and Bootstrap
    –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>


    <style>

    #name {
    width: 100%;
    height: 600px;
    /*background-image: url("static/sunny.png");*/
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    }

    #display-temp {
      font-size: 200%;
      padding-top: 50px;
      padding-bottom: 50px;
    }

    #display-humidity {
      font-size: 200%;
      padding-top: 50px;
    }

    #display-weather {
      font-size: 200%;
      padding-top: 50px;
    }

    #display-icon {
      padding-top: 50px;
    }

    #overlay-box {
      background-color: rgba(256,256,256,0.3);
      z-index: 2;
      padding-top: 25px;
      padding-bottom: 30px;
      border-radius: 25px;
      border: 1px solid darkgray;
    }

    #overlay-box2 {
      background-color: rgba(256,256,256,0.3);
      z-index: 2;
      border-radius: 25px;
    }


    </style>

</head>

<body>


<script>
  $(document).ready(function() {

    // sunny[0], overcast[1], raining[2], thunder[3], snow[4], default[5]
    weatherBackgrounds = ["static/sunny.png", "static/overcast.jpg", "static/rain.jpg", "static/thunder.png","static/snow.jpg", "static/default.png", "static/default2.jpg" ];


  function getWeather() {
    var coords = {
      lat: latitude,
      lon: longitude,
    };

    $.get("/get-weather", coords, function(results){

      weatherObject = JSON.parse(results);
      var weather = weatherObject[0];
      var icon = weatherObject[1];
      var humidity = weatherObject[2];
      var temp = weatherObject[3];


      // select the correct background image based on the local weather
      // if none found, defaults to generic image
      if (weather === 'sunny') {
        image = weatherBackgrounds[0];
      } else if (weather === 'overcast') {
        image = weatherBackgrounds[1];
      } else if (weather === 'rain') {
        image = weatherBackgrounds[2];
      } else if (weather === 'thunderstorm') {
        image = weatherBackgrounds[3];
      } else if (weather === 'snow') {
        image = weatherBackgrounds[4];
      } else {
        image = weatherBackgrounds[6];
      }

      $('#name').css('background-image', 'url(' + image + ')');
      $('#display-temp').html(temp + '°C');
      $('#display-weather').html(weather);
      $('#display-humidity').html("humidity: " + humidity);
      $('#display-icon').attr("src", icon);

      var farenheit = (parseInt(temp) * 1.8) + 32;

      var ckbox = $('#Farenheit');
      $('input').on('click', function() {
        if (ckbox.is(':checked')) {
          $('#display-temp').html(farenheit + '°F');
        }
      });

    });

  }



  function getLocation() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
          latitude = position.coords.latitude;
          longitude = position.coords.longitude;
          console.log("lat: " + latitude);

          getWeather(latitude, longitude);
        });
    // } else {
    //     x.innerHTML = "Geolocation is not supported by this browser.";
    // }


    }
  }


  getLocation();

  });

</script>

<!-- ToDo:

-fix non-responsive design - display box doesn't size correctly
-Jasmine testing -->

<div class="container-fluid">

  <div class="row">
    <div class="col-xs-12" id="name">
      <div class="col-xs-offset-1 col-xs-11" id="welcome">
        <h1>Your Local Weather</h1>
      </div>

      <div class="col-xs-offset-2 col-xs-8" id="overlay-box">
        <div class="col-xs-offset-1 col-xs-1" id="display-temp">
          <h2>temp:</h2>
        </div>
        <div class="col-xs-offset-1 col-xs-2" id="display-weather">
          <h2>weather:</h2>
        </div>
        <div class="col-xs-offset-1 col-xs-3" id="display-humidity">
          <h2>humidity:</h2>
        </div>
        <div class="col-xs-2">
          <img id="display-icon" src="https://cdn.glitch.com/6e8889e5-7a72-48f0-a061-863548450de5%2F10n.png">
        </div>

      </div>


      <div class="col-xs-offset-2 col-xs-2" id="overlay-box2">
        <form action="">
          <input type="checkbox" id="Farenheit" value="Farenheit">Display temp in °F<br>
        </form>
      </div>


    </div>
  </div>
</div>




</body>

</html>


